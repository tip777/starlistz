
[1mFrom:[0m /home/ubuntu/workspace/starlistz/app/controllers/lists_controller.rb @ line 70 ListsController#saleslist:

    [1;34m64[0m: [32mdef[0m [1;34msaleslist[0m
    [1;34m65[0m:   @list = [1;34;4mList[0m.find(params[[33m:list_id[0m])
    [1;34m66[0m:   @user = [1;34;4mUser[0m.find(@list.user.id)
    [1;34m67[0m:   [32mif[0m current_user != [1;36mnil[0m && current_user.id == @user.id
    [1;34m68[0m:     [32mif[0m params[[33m:date[0m] != [1;36mnil[0m
    [1;34m69[0m:       binding.pry
 => [1;34m70[0m:       @sales_amount = [1;34;4mPurchase[0m.where([35mlist_id[0m: @list.id, [35morder_date[0m: paramas[[33m:date[0m].in_time_zone.all_month ).count * @list.price
    [1;34m71[0m:     [32melse[0m
    [1;34m72[0m:       @sales_amount = [1;34;4mPurchase[0m.where([35mlist_id[0m: @list.id).count * @list.price
    [1;34m73[0m:     [32mend[0m
    [1;34m74[0m:     @date_list = [1;34;4mPurchase[0m.where([35mlist_id[0m: @list.id).group([31m[1;31m"[0m[31mMONTH(order_date)[1;31m"[0m[31m[0m).order([35morder_date[0m: [33m:desc[0m).pluck([33m:order_date[0m) [1;34m#購入履歴を月でまとめる[0m
    [1;34m75[0m:     [32mif[0m @date_list[[1;34m1[0m].nil?
    [1;34m76[0m:       now_date = [1;34;4mTime[0m.now
    [1;34m77[0m:       @date_list.push(now_date.strftime([31m[1;31m"[0m[31m%Y/%m[1;31m"[0m[31m[0m))
    [1;34m78[0m:     [32melse[0m
    [1;34m79[0m:       @date_list.each_with_index [32mdo[0m |item, i|
    [1;34m80[0m:         @date_list[i] = @date_list[i].strftime([31m[1;31m"[0m[31m%Y/%m[1;31m"[0m[31m[0m)
    [1;34m81[0m:       [32mend[0m
    [1;34m82[0m:     [32mend[0m
    [1;34m83[0m:   [32melse[0m
    [1;34m84[0m:     reject_page
    [1;34m85[0m:   [32mend[0m
    [1;34m86[0m: [32mend[0m

