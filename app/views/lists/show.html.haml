.container-fluid.l-container
  //ログインしていたら編集できる
  - if is_signin
    - if is_signed(current_user.id, @list.user.id)
      =link_to 'プレイリスト編集', edit_list_path(@list, list: @list)


  .l-playlist
    .ll-playlist
      = image_tag @list.image.url(:thumb)

    .rr-playlist
      %h3 プレイリスト名
      .span.listtitle= @list.title
      / Stripe決済部分
      = render "charges/stripe_checkout", customer: @customer, list: @list


      %h3 詳細
      .span= @list.description

      .span= render 'layouts/tag_list', tag_list: @list.tag_list

      %h3 金額
      .span #{@list.price}円


  %table.table.table-bordered.table-sortable
    %tbody#lines
      %tr
        %th アーティスト
        %th 曲名
        %th 説明
        %th スター
    - @list.tracks.sort_by(&:row_order).each_with_index do |track, i|
      %tr.track
        %td= track.artist
        %td= track.song
        %td= track.description
        %td
          = check_box 'track', 'recommend', {:checked => track.recommend, :disabled  => true, id: "custom-checkbox#{i}", class: "custom-check-box"}
          %label{for: "custom-checkbox#{i}"}
          
  :javascript
    // 購入ボタンクリック時判定
      $(document).on('turbolinks:load', function() {
        $('.stripe-button-el').hide();
        $('.buy_btn').on('click', function(e){
          if(gon.current_user == null){
            console.log("してない");
            window.location.href = "/users/sign_in"; // 通常の遷移
          }else{
            $('.stripe-button-el').trigger('click');
          }
          console.log(gon.current_user);
          e.preventDefault();
        });
      });
